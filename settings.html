<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings | Lost & Found Hub</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        /* Header styles */
        header {
            background-color: #fff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }
        
       .logo {
            font-size: 1.8em;
            font-weight: bold;
            color: #4CAF50;;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .logo a {
            text-decoration: none;
            color:#4CAF50;;
        }   

        .logo i {
            font-size: 1.2em;
        }

        .nav-btn:hover{
            color: #388E3C;

        }
        
        nav ul {
            display: flex;
            list-style: none;
        }
        
        nav ul li a {
            text-decoration: none;
            color: black;
            padding: 10px 15px;
            border-radius: 4px;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
        }
        
        nav ul li a:hover {
            background-color: #e9ecef;;
            color: #007BFF;
        }
        
        nav ul li a i {
            margin-right: 8px;
        }
        
        .account-section {
            position: relative;
        }
        
        .account-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #42aa46;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.3s;
            overflow: hidden;
            border: 2px solid #007BFF;
        }
        
        .account-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .account-icon:hover {
            background-color: #2c8230;
        }
        
        .dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            width: 280px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 20px;
            margin-top: 10px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .dropdown.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
            margin-bottom: 15px;
        }
        
        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #4CAF50;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            margin-right: 15px;
            overflow: hidden;
            border: 2px solid #007BFF;
        }
        
        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .user-details h3 {
            margin-bottom: 5px;
            font-size: 1rem;
        }
        
        .user-details p {
            color: #777;
            font-size: 0.9rem;
        }
        
        .dropdown-menu {
            list-style: none;
            padding: 10px 0;
            margin: 0;
        }
        .dropdown-menu li {
            margin: 0;
        }
        .dropdown-menu li a {
            padding: 10px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            color: #333;
            text-decoration: none;
        }
        .dropdown-menu li a:hover {
            background-color: #f4f7f6;
        }
        .logout-btn {
            color: #e74c3c !important;
        }

        .hamburger-menu {
            display: none; 
            font-size: 1.8em;
            color: #333;
            cursor: pointer;
            background: none;
            border: none;
            padding: 5px;
            border-radius: 8px;
            transition: background-color 0.3s ease;
        }

        .hamburger-menu:hover {
            background-color: #e9ecef;
        }

        
        /* Main content */
        main {
            padding: 30px 0;
            flex: 1;
        }
        
        h1 {
            font-size: 2rem;
            margin-bottom: 20px;
            color: #333;
        }
        
        /* Settings styles */
        .settings-layout {
            display: flex;
            gap: 30px;
            margin-top: 20px;
        }

        .settings-sidebar {
            flex: 0 0 250px;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            height: fit-content;
        }

        .settings-sidebar .nav-menu {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .settings-sidebar .nav-menu li a {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            text-decoration: none;
            color: #555;
            border-radius: 6px;
            margin-bottom: 5px;
            transition: background-color 0.3s, color 0.3s;
        }

        .settings-sidebar .nav-menu li a i {
            margin-right: 15px;
            width: 20px;
        }

        .settings-sidebar .nav-menu li a:hover,
        .settings-sidebar .nav-menu li a.active {
            background-color: #e8f5e9;
            color: #4CAF50;
            font-weight: 600;
        }

        .settings-content {
            flex-grow: 1;
        }

        .settings-content .setting-section {
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            display: none;
        }
        
        .settings-content .setting-section.active {
            display: block;
        }

        .setting-section h2 {
            margin-top: 0;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
            color: #4CAF50;
            text-align: left;
        }

        /* Account Status Styles */
        .account-status {
            margin-top: 20px;
        }
        
        .account-status p {
            margin-bottom: 12px;
            font-size: 1.1rem;
        }
        
        .account-status strong {
            color: #333;
        }

        /* Footer styles */
        footer {
            background-color: #333;
            color: #fff;
            padding: 40px 0;
            margin-top: auto;
        }
        
        .footer-content {
            max-width: 600px;
            margin: 0 auto;
            text-align: center;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }

        .footer-links a {
            color: white;
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-links a:hover {
            color: #4CAF50;
        }

        /* Modal Styles */
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            display: none;
        }

        .modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
            z-index: 2001;
            width: 90%;
            max-width: 700px;
            max-height: 80vh;
            overflow-y: auto;
            display: none;
        }

        .modal.active {
            display: block;
        }

        .modal-backdrop.active {
            display: block;
        }

        .modal-content {
            padding: 20px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
            margin-bottom: 15px;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 1.5em;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #aaa;
        }

        .close-btn:hover {
            color: #333;
        }

        .modal-body {
            padding: 10px 0;
        }

        .modal-body h4 {
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .modal-body ul {
            padding-left: 20px;
            margin-bottom: 15px;
        }

        /* Footer Modal Styles */
        .footer-modal {
            max-width: 650px;
        }

        .footer-modal .modal-content {
            padding: 20px 30px;
        }

        .footer-modal .modal-header h3 {
            margin: 0;
            font-size: 1.5em;
            color: #007BFF;
        }

        .footer-modal .modal-body ul {
            padding-left: 20px;
        }

        .footer-modal .modal-body h4 {
            margin-top: 20px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .settings-layout {
                flex-direction: column;
            }
            .settings-sidebar {
                flex: 1;
            }
            
            nav {
                display: none;
            }
            
            .hamburger-menu {
                display: block;
            }
            
            .footer-links {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-content">
            <div class="logo">
                <a href="index.html">
                    <i class="fas fa-search-location" style="color: #007BFF;"></i>
                        <span>Lost & Found Hub</span>
                </a>
            </div>
            <nav>
                <ul>
                    <li><a href="index.html" aria-label="Home"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="submit-item.html" id="navSubmitItem" aria-label="Submit Item"><i class="fas fa-plus-circle"></i> Submit Item</a></li>
                </ul>
            </nav>
            <div class="account-section" id="accountSection">
                <div class="account-icon" id="accountIcon">
                    <i class="fas fa-user" id="accountIconFallback"></i>
                    <img id="accountIconImage" style="display: none;" alt="User Avatar">
                </div>
                <div class="dropdown" id="accountDropdown">
                    <div class="user-info">
                        <div class="user-avatar">
                            <i class="fas fa-user" id="dropdownAvatarFallback"></i>
                            <img id="dropdownAvatarImage" style="display: none;" alt="User Avatar">
                        </div>
                        <div class="user-details">
                            <h3 id="username">nivesharm</h3>
                            <p id="useremail">nivesharm@example.com</p>
                        </div>
                    </div>
                    <ul class="dropdown-menu">
                        <li><a href="profile.html"><i class="fas fa-user-circle"></i> Your Profile</a></li>
                        <li><a href="help.html"><i class="fas fa-question-circle"></i> Help & Support</a></li>
                        <li><a href="#"><i class="fas fa-bell"></i> Notifications</a></li>
                        <li><a href="contact.html" aria-label="Home"><i class="fas fa-phone contact-icons"></i> Contact</a></li>
                        <li><a href="login.html" class="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
                    </ul>
                </div>
            </div>
            <div class="hamburger-menu" role="button" id="hamburgerMenu"><i class="fas fa-bars"></i></div>
        </div>
    </header>

    <main class="container">
        <h1>Settings</h1>
        <div class="settings-layout">
            <aside class="settings-sidebar">
                <ul class="nav-menu">
                    <li><a href="#accountsettings" class="settings-link active"><i class="fas fa-cog"></i> Account Settings</a></li>
                </ul>
            </aside>
            <div class="settings-content">
                <section id="accountsettings" class="setting-section active">
                    <h2>Account Settings</h2>
                    <div class="account-status">
                        <p><strong>Account Status:</strong> <span style="color: green;">Active</span></p>
                        <p><strong>Email Verified:</strong> <span style="color: green;">Yes</span></p>
                        <p><strong>Two-Factor Auth:</strong> <span style="color: #e74c3c;">Disabled</span></p>
                        <p><strong>Login Count:</strong> <span id="loginCount">142</span></p>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <p>&copy; 2025 College Lost & Found Hub. All rights reserved.</p>
            <div class="footer-links">
                <a href="#" id="privacyLink" aria-label="Privacy Policy">Privacy Policy</a> | 
                <a href="#" id="serviceLink" aria-label="Terms of Service">Terms of Service</a> | 
                <a href="#" id="termsLink" aria-label="Terms & Conditions">Terms & Conditions</a>
            </div>
        </div>
    </footer>

    <!-- Modals -->
    <div class="modal-backdrop" id="modalBackdrop"></div>

    <div class="modal footer-modal" id="privacyModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Lost & Found Hub - Privacy Policy</h3>
          <button class="close-btn">&times;</button>
        </div>
        <div class="modal-body">
                <h4>1. Information We Collect</h4>
                <p>To provide our lost and found matching services, we collect:
                    <ul>
                        <li>Account information (name, email, contact details)</li>
                        <li>Item descriptions and photos you choose to share</li>
                        <li>Location data to help match lost and found items geographically</li>
                        <li>Communication history between users regarding items</li>
                        <li>Technical data (IP address, browser type, device information)</li>
                    </ul>
                </p>
                
                <h4>2. How We Use Your Information</h4>
                <p>We use collected information to:
                    <ul>
                        <li>Match lost items with found items in your area</li>
                        <li>Facilitate communication between users</li>
                        <li>Improve our matching algorithms and user experience</li>
                        <li>Send notifications about potential matches</li>
                        <li>Ensure platform security and prevent fraud</li>
                        <li>Comply with legal obligations</li>
                    </ul>
                </p>
                
                <h4>3. Item Information Sharing</h4>
                <p>To help reunite items with their owners, we may share:
                    <ul>
                        <li>Item descriptions and photos with other users in your area</li>
                        <li>General location data (neighborhood/city level, not exact addresses)</li>
                        <li>Contact method you choose to share (platform messaging or provided contact info)</li>
                    </ul>
                    We never share your exact address, phone number, or personal financial information without your explicit consent.
                </p>
                
                <h4>4. Data Security</h4>
                <p>We implement security measures to protect your information:
                    <ul>
                        <li>Encryption of sensitive data in transit and at rest</li>
                        <li>Regular security assessments and updates</li>
                        <li>Limited employee access to user data</li>
                        <li>Secure authentication procedures</li>
                    </ul>
                </p>
                
                <h4>5. Your Privacy Choices</h4>
                <p>You can:
                    <ul>
                        <li>Adjust visibility settings for your listings</li>
                        <li>Choose which contact methods to share</li>
                        <li>Delete your account and associated data</li>
                        <li>Opt-out of non-essential communications</li>
                        <li>Request access to your personal data</li>
                    </ul>
                </p>
                
                <h4>6. Location Data</h4>
                <p>We use location information to:
                    <ul>
                        <li>Show relevant lost and found items in your area</li>
                        <li>Improve matching accuracy</li>
                        <li>Provide location-based notifications</li>
                    </ul>
                    You can control location sharing through your device settings and our app permissions.
                </p>
                
                <h4>7. Data Retention</h4>
                <p>We retain your information:
                    <ul>
                        <li>While your account is active</li>
                        <li>For resolved item listings: 90 days after resolution</li>
                        <li>For unresolved listings: Until you delete them or 1 year</li>
                        <li>As required by law for legal compliance</li>
                    </ul>
                </p>
                
                <h4>8. Changes to Privacy Policy</h4>
                <p>We will notify users of significant changes to our privacy practices. Continued use of Lost & Found Hub after changes constitutes acceptance of the updated policy.</p>
                
                <h4>9. Contact Us</h4>
                <p>For privacy-related questions or concerns, please contact our privacy team at privacy@lostfoundhub.com</p>
            </div>
      </div>
    </div>

    <div class="modal footer-modal" id="serviceModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Lost & Found Hub - Terms of Service</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <h4>1. Our Service</h4>
                <p>Welcome to Lost & Found Hub. Our service provides a platform to help users post and search for lost and found items within a specific community. We aim to facilitate the return of belongings but do not participate in the exchange or guarantee outcomes.</p>
                <h4>2. User Accounts</h4>
                <p>To post an item, you may be required to create an account. You agree to provide truthful information and are responsible for maintaining the confidentiality of your account password. You are solely responsible for all activities that occur under your account.</p>
                <h4>3. Acceptable Use Policy</h4>
                <p>You agree not to use the service to post false or misleading information, harass other users, or post unlawful content.</p>
                <h4>4. User-Generated Content</h4>
                <p>You retain ownership of the content you post. However, by posting, you grant Lost & Found Hub a license to display that content on our platform for the purpose of operating the service.</p>
                <h4>5. Termination</h4>
                <p>We reserve the right to suspend or terminate your access to the service at our discretion for any conduct that violates these terms.</p>
            </div>
        </div>
    </div>

    <div class="modal footer-modal" id="termsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Lost & Found Hub - Terms & Conditions</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <h4>1. Acceptance of Terms</h4>
                <p>By accessing and using Lost & Found Hub, you accept and agree to be bound by these Terms & Conditions. Our platform connects people who have lost items with those who have found them.</p>
                
                <h4>2. User Responsibilities</h4>
                <p>As a user of Lost & Found Hub, you agree to:
                    <ul>
                        <li>Provide accurate information about lost or found items</li>
                        <li>Respond promptly to legitimate inquiries about your listings</li>
                        <li>Treat other users with respect and courtesy</li>
                        <li>Not list prohibited or illegal items</li>
                        <li>Verify ownership before returning found items</li>
                    </ul>
                </p>
                
                <h4>3. Item Listings and Verification</h4>
                <p>Lost & Found Hub serves as a connection platform only. We do not:
                    <ul>
                        <li>Verify the accuracy of user listings</li>
                        <li>Guarantee the return of lost items</li>
                        <li>Take possession of any lost or found items</li>
                        <li>Mediate disputes between users</li>
                    </ul>
                    Users are responsible for verifying ownership through reasonable means before transferring items.
                </p>
                
                <h4>4. Prohibited Items</h4>
                <p>You may not list the following items on our platform:
                    <ul>
                        <li>Weapons, firearms, or ammunition</li>
                        <li>Illegal substances or drugs</li>
                        <li>Hazardous materials</li>
                        <li>Stolen property</li>
                        <li>Perishable items</li>
                        <li>Animals or pets</li>
                    </ul>
                </p>
                
                <h4>5. Safe Exchange Guidelines</h4>
                <p>For your safety, we recommend:
                    <ul>
                        <li>Meeting in public, well-lit areas</li>
                        <li>Bringing a friend or family member</li>
                        <li>Verifying the item matches the description</li>
                        <li>Not sharing personal financial information</li>
                        <li>Reporting suspicious activity to local authorities</li>
                    </ul>
                </p>
                
                <h4>6. Limitation of Liability</h4>
                <p>Lost & Found Hub is not responsible for:
                    <ul>
                        <li>Items that are not returned or claimed</li>
                        <li>Misrepresentation of items by users</li>
                        <li>User interactions or exchanges</li>
                        <li>Damages or losses resulting from platform use</li>
                        <li>Technical issues that may temporarily limit access</li>
                    </ul>
                </p>
                
                <h4>7. Account Termination</h4>
                <p>We reserve the right to suspend or terminate accounts that:
                    <ul>
                        <li>Violate these terms and conditions</li>
                        <li>Engage in fraudulent or suspicious activity</li>
                        <li>Harass other users</li>
                        <li>Repeatedly post inaccurate information</li>
                    </ul>
                </p>
                
                <h4>8. Changes to Terms</h4>
                <p>We may update these Terms & Conditions periodically. Continued use of Lost & Found Hub after changes constitutes acceptance of the modified terms.</p>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Settings navigation
            const links = document.querySelectorAll('.settings-link');
            const sections = document.querySelectorAll('.setting-section');

            links.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();

                    // Update active link
                    links.forEach(l => l.classList.remove('active'));
                    this.classList.add('active');

                    // Show corresponding section
                    const targetId = this.getAttribute('href').substring(1);
                    sections.forEach(section => {
                        if (section.id === targetId) {
                            section.classList.add('active');
                        } else {
                            section.classList.remove('active');
                        }
                    });
                });
            });
            
            // Account dropdown
            const accountIcon = document.getElementById('accountIcon');
            const accountDropdown = document.getElementById('accountDropdown');
            
            if(accountIcon) {
                accountIcon.addEventListener('click', (e) => {
                    e.stopPropagation();
                    accountDropdown.classList.toggle('active');
                });
            }
            
            // Close dropdown when clicking outside
            document.addEventListener('click', () => {
                if(accountDropdown.classList.contains('active')) {
                    accountDropdown.classList.remove('active');
                }
            });
            
            // Prevent dropdown from closing when clicking inside it
            accountDropdown.addEventListener('click', (e) => {
                e.stopPropagation();
            });
            
            // Hamburger menu functionality
            const hamburgerMenu = document.getElementById('hamburgerMenu');
            const nav = document.querySelector('nav');
            
            if(hamburgerMenu) {
                hamburgerMenu.addEventListener('click', () => {
                    nav.style.display = nav.style.display === 'block' ? 'none' : 'block';
                });
            }

            // Avatar functionality
            const accountIconImage = document.getElementById('accountIconImage');
            const accountIconFallback = document.getElementById('accountIconFallback');
            const dropdownAvatarImage = document.getElementById('dropdownAvatarImage');
            const dropdownAvatarFallback = document.getElementById('dropdownAvatarFallback');

            // Load user avatar on page load
            loadUserAvatar();

            // Load user profile on page load
            loadUserProfile();
            
            // Modal Management
            const modalManager = {
                currentModal: null,
                
                openModal: function(modalId) {
                    // Close any currently open modal
                    this.closeCurrentModal();
                    
                    // Show the backdrop
                    document.getElementById('modalBackdrop').classList.add('active');
                    
                    // Show the requested modal
                    const modal = document.getElementById(modalId);
                    modal.classList.add('active');
                    this.currentModal = modal;
                    
                    // Prevent body scrolling
                    document.body.style.overflow = 'hidden';
                },
                
                closeCurrentModal: function() {
                    if (this.currentModal) {
                        this.currentModal.classList.remove('active');
                        this.currentModal = null;
                    }
                    
                    // Hide backdrop
                    document.getElementById('modalBackdrop').classList.remove('active');
                    
                    // Restore body scrolling
                    document.body.style.overflow = '';
                }
            };

            // Modal open buttons
            const privacyLink = document.getElementById('privacyLink');
            const serviceLink = document.getElementById('serviceLink');
            const termsLink = document.getElementById('termsLink');

            privacyLink.addEventListener('click', function(e) {
                e.preventDefault();
                modalManager.openModal('privacyModal');
            });

            serviceLink.addEventListener('click', function(e) {
                e.preventDefault();
                modalManager.openModal('serviceModal');
            });

            termsLink.addEventListener('click', function(e) {
                e.preventDefault();
                modalManager.openModal('termsModal');
            });

            // Close modal event listeners for all modals
            document.querySelectorAll('.close-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    modalManager.closeCurrentModal();
                });
            });

            // Close modal when clicking on backdrop
            document.getElementById('modalBackdrop').addEventListener('click', function() {
                modalManager.closeCurrentModal();
            });

            // Close modal with Escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    modalManager.closeCurrentModal();
                }
            });
        });

        // API Functions
        async function loadUserProfile() {
            const token = localStorage.getItem("authToken");

            if (!token) {
                document.getElementById("username").textContent = "Guest";
                document.getElementById("useremail").textContent = "Not logged in";
                return;
            }

            try {
                const response = await fetch("http://localhost:3000/api/profile", {
                    method: "GET",
                    headers: {
                        "Authorization": `Bearer ${token}`,
                        "Content-Type": "application/json"
                    }
                });

                const result = await response.json();

                if (result.success) {
                    const user = result.user;

                    // Update dropdown
                    document.getElementById('username').textContent = user.username || user.name || "No Name";
                    document.getElementById('useremail').textContent = user.email;
                    
                    // Set avatar in all locations if available
                    if (user.avatar) {
                        updateAllAvatars(user.avatar);
                    } else {
                        // Use default avatar
                        updateAllAvatars('https://i.pravatar.cc/150?img=12');
                    }
                } else {
                    document.getElementById("username").textContent = "Error";
                    document.getElementById("useremail").textContent = result.message;
                }
            } catch (err) {
                console.error("Profile fetch failed:", err);
                document.getElementById("username").textContent = "Error";
                document.getElementById("useremail").textContent = "Could not load profile";
            }
        }

        async function loadUserAvatar() {
            const token = localStorage.getItem("authToken");
            
            if (!token) {
                return;
            }

            try {
                const response = await fetch("http://localhost:3000/api/profile", {
                    method: "GET",
                    headers: {
                        "Authorization": `Bearer ${token}`,
                        "Content-Type": "application/json"
                    }
                });

                const result = await response.json();

                if (result.success && result.user.avatar) {
                    updateAllAvatars(result.user.avatar);
                } else {
                    // Use default avatar if none exists
                    updateAllAvatars('https://i.pravatar.cc/150?img=12');
                }
            } catch (err) {
                console.error("Avatar fetch failed:", err);
                // Use default avatar on error
                updateAllAvatars('https://i.pravatar.cc/150?img=12');
            }
        }

        // Function to update avatar in all locations
        function updateAllAvatars(avatarUrl) {
            // Update account icon avatar
            const accountIconImage = document.getElementById('accountIconImage');
            const accountIconFallback = document.getElementById('accountIconFallback');
            
            if (avatarUrl && avatarUrl !== '') {
                accountIconImage.src = avatarUrl;
                accountIconImage.style.display = 'block';
                accountIconFallback.style.display = 'none';
                
                // Update dropdown avatar
                const dropdownAvatarImage = document.getElementById('dropdownAvatarImage');
                const dropdownAvatarFallback = document.getElementById('dropdownAvatarFallback');
                dropdownAvatarImage.src = avatarUrl;
                dropdownAvatarImage.style.display = 'block';
                dropdownAvatarFallback.style.display = 'none';
            } else {
                // Show fallback icons if no avatar
                accountIconImage.style.display = 'none';
                accountIconFallback.style.display = 'block';
                dropdownAvatarImage.style.display = 'none';
                dropdownAvatarFallback.style.display = 'block';
            }
        }
    </script>
</body>
</html>