<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Submit an Item | Lost & Found Portal</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="forms.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <style>
        /* Header Styles */
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            max-width: 1200px;
            margin: 0 auto;
            width: 90%;
        }

        .logo {
            font-size: 1.8em;
            font-weight: bold;
            color: #4CAF50;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .logo a {
            text-decoration: none;
            color: #4CAF50;
        }

        .logo i {
            font-size: 1.2em;
            color:#007BFF;
        }

        nav {
            flex: 1;
            max-width: 300px;
            margin: 0 20px;
        }

        nav ul {
            display: flex;
            list-style: none;
            justify-content: space-between;
        }
        
        nav ul li a {
            text-decoration: none;
            color: black;
            padding: 10px 15px;
            border-radius: 4px;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            white-space: nowrap;
        }

        nav ul li a:hover {
            background-color: #e9ecef;
            color: #007BFF;          
        }

        nav ul li a i {
            margin-right: 8px;
        }

        .account-section {
            position: relative;
        }
        
        .account-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #4CAF50;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.3s;
            overflow: hidden;
            position: relative;
            border: 3px solid #007BFF;
        }
        
        .account-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: none;
        }
        
        .account-icon .fa-user {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        
        .account-icon:hover {
            background-color: #3d8b40;
        }
        
        .dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            width: 280px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 20px;
            margin-top: 10px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .dropdown.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .dropdown-user-info {
            display: flex;
            align-items: center;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
            margin-bottom: 15px;
        }
        
        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #4CAF50;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            margin-right: 15px;
            overflow: hidden;
            position: relative;
            border: 3px solid #007BFF;
        }
        
        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: none;
        }
        
        .user-avatar .fa-user {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        
        .user-details h3 {
            margin-bottom: 5px;
            font-size: 1rem;
        }
        
        .user-details p {
            color: #777;
            font-size: 0.9rem;
        }
        
        .dropdown-menu {
            list-style: none;
            padding: 10px 0;
            margin: 0;
        }
        .dropdown-menu li {
            margin: 0;
        }
        .dropdown-menu li a {
            padding: 10px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            color: #333;
            text-decoration: none;
        }
        .dropdown-menu li a:hover {
            background-color: #f4f7f6;
        }
        .logout-btn {
            color: #e74c3c !important;
        }

        .hamburger-menu {
            display: none; 
            font-size: 1.8em;
            color: #333;
            cursor: pointer;
            background: none;
            border: none;
            padding: 5px;
            border-radius: 8px;
            transition: background-color 0.3s ease;
        }

        .hamburger-menu:hover {
            background-color: #f5f7fa;
        }

        header {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        /* Modal and Form Styles */
        .success-modal-backdrop {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            justify-content: center;
            align-items: center;
        }

        .success-modal {
            background-color: white;
            padding: 30px 40px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
            max-width: 90%;
            width: 400px;
        }

        .success-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: #28a745;
            color: white;
            font-size: 40px;
            margin: 0 auto 20px auto;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .success-button {
            background-color: #007BFF;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 15px;
            transition: background-color 0.3s;
        }

        .success-button:hover {
            background-color: #0056b3;
        }

        .loading-spinner {
            display: none;
            text-align: center;
            margin: 20px 0;
        }

        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top: 4px solid #007BFF;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        .image-preview {
            display: none;
            margin-top: 10px;
            text-align: center;
        }

        .image-preview img {
            max-width: 200px;
            max-height: 200px;
            border-radius: 8px;
            border: 2px solid #ddd;
        }

        .remove-image {
            margin-top: 5px;
            background: #dc3545;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
        }

        /* Info Icon and Tooltip Styles */
        .submit-section {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 20px;
        }

        .info-icon-container {
            position: relative;
            display: inline-block;
        }

        .info-icon {
            color: #007BFF;
            font-size: 1.5rem;
            cursor: pointer;
            transition: color 0.3s;
        }

        .info-icon:hover {
            color: #0056b3;
        }

        .info-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: white;
            padding: 10px 15px;
            border-radius: 6px;
            font-size: 0.9rem;
            white-space: nowrap;
            margin-bottom: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            
        }

        .info-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border-width: 6px;
            border-style: solid;
            border-color: #333 transparent transparent transparent;
        }

        .info-icon-container:hover .info-tooltip {
            opacity: 1;
            visibility: visible;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Footer */
        footer {
            background: #343a40;
            color: white;
            padding: 40px 0;
            text-align: center;
        }

        .footer-content {
            max-width: 600px;
            margin: 0 auto;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }

        .footer-links a {
            color: var(--light);
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-links a:hover {
            color: #4CAF50;
        }

        .copyright {
            margin-top: 20px;
            color: var(--gray);
            font-size: 0.9rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content { 
                flex-direction: column; 
                gap: 10px; 
            }
            nav ul {
                flex-direction: column;
                gap: 10px;
            }
            .hamburger-menu {
                display: block;
            }
            nav {
                display: none;
            }
            nav.active {
                display: block;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                background: white;
                padding: 20px;
                box-shadow: 0 5px 10px rgba(0,0,0,0.1);
            }
            
            .submit-section {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .info-tooltip {
                left: 0;
                transform: none;
            }
            
            .info-tooltip::after {
                left: 20px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo">
                <i class="fas fa-search-location" style="color: #007BFF;"></i>
                <a href="index.html"><span>Lost & Found Hub</span></a>
            </div>
            <nav id="mainNav">
                <ul>
                    <li><a href="index.html"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="contact.html"><i class="fas fa-phone contact-icons"></i> Contact</a></li>
                </ul>
            </nav>
            <div class="account-section" id="accountSection">
                <div class="account-icon" id="accountIcon">
                    <i class="fas fa-user" id="accountIconFallback"></i>
                    <img id="accountIconImage" alt="User Avatar">
                </div>
                <div class="dropdown" id="accountDropdown">
                    <div class="dropdown-user-info">
                        <div class="user-avatar">
                            <i class="fas fa-user" id="dropdownAvatarFallback"></i>
                            <img id="dropdownAvatarImage" alt="User Avatar">
                        </div>
                        <div class="user-details">
                            <h3 id="username">nivesharm</h3>
                            <p id="useremail">nivesharm@example.com</p>
                        </div>
                    </div>
                    <ul class="dropdown-menu">
                        <li><a href="profile.html"><i class="fas fa-user-circle"></i> Your Profile</a></li>
                        <li><a href="submit-item.html" id="navSubmitItem" aria-label="Submit Item"><i class="fas fa-plus-circle"></i> Submit Item</a></li>
                        <li><a href="help.html"><i class="fas fa-question-circle"></i> Help & Support</a></li>
                        <li><a href="#"><i class="fas fa-bell"></i> Notifications</a></li>
                        <li><a href="settings.html"><i class="fas fa-cog"></i> Settings</a></li>
                        <li><a href="login.html" class="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
                    </ul>
                </div>
            </div>
            <button class="hamburger-menu" id="hamburgerMenu" aria-label="Toggle navigation menu">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <main class="container form-page">
        <section class="form-section">
            <h1>Report a Lost or Found Item</h1>
            <form id="itemForm" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="itemType">Are you reporting a:</label>
                    <div class="radio-group">
                        <input type="radio" id="itemTypeLost" name="itemType" value="Lost" required>
                        <label class="lost-red" for="itemTypeLost"><i class="fas fa-times-circle"></i> Lost Item</label>
                        <input type="radio" id="itemTypeFound" name="itemType" value="Found">
                        <label for="itemTypeFound"><i class="fas fa-check-circle"></i> Found Item</label>
                    </div>
                    <span class="error-message" id="itemType-error">Please select an item type.</span>
                </div>

                <div class="form-group">
                    <label for="itemName">Item Name <span class="required">*</span></label>
                    <input type="text" id="itemName" name="itemName" required placeholder="e.g., Blue Water Bottle, Black Leather Wallet">
                    <span class="error-message" id="itemName-error">Item name is required.</span>
                </div>

                <div class="form-group">
                    <label for="category">Category <span class="required">*</span></label>
                    <select id="category" name="category" required>
                        <option value="">Select a category</option>
                        <option value="Electronics">Electronics (Laptop, Phone, Charger)</option>
                        <option value="ID Cards">ID Cards (Student ID, Driver's License)</option>
                        <option value="Wallets">Wallets/Purses</option>
                        <option value="Books">Books/Notebooks</option>
                        <option value="Clothing">Clothing/Accessories</option>
                        <option value="Keys">Keys</option>
                        <option value="Jewelry">Jewelry</option>
                        <option value="Bags">Bags/Backpacks</option>
                        <option value="Writing Instruments">Writing Instruments (Pens, Pencils)</option>
                        <option value="Sports Equipment">Sports Equipment</option>
                        <span style="color: red;"><option value="Other">Other - Please mention in description</option></span>
                    </select>
                    <span class="error-message" id="category-error">Category is required.</span>
                </div>

                <div class="form-group">
                    <label for="description">Description <span class="required">*</span></label>
                    <textarea id="description" name="description" rows="5" required placeholder="Provide details like color, brand, unique markings, contents (if applicable)."></textarea>
                    <span class="error-message" id="description-error">Description is required.</span>
                </div>

                <div class="form-group">
                    <label for="location">Location (Where it was lost/found) <span class="required">*</span></label>
                    <input type="text" id="location" name="location" required placeholder="e.g., CSE Lab, Library 3rd Floor, Near Main Gate">
                    <span class="error-message" id="location-error">Location is required.</span>
                </div>

                <div class="form-group">
                    <label for="date">Date <span class="required">*</span></label>
                    <input type="date" id="date" name="date" required>
                    <span class="error-message" id="date-error">Date is required.</span>
                </div>

                <div class="form-group">
                    <label for="contactEmail">Your Contact Email <span class="required">*</span></label>
                    <input type="email" id="contactEmail" name="contactEmail" required placeholder="your.email@example.com">
                    <span class="error-message" id="contactEmail-error">A valid email is required.</span>
                </div>

                <div class="form-group">
                    <label for="contactPhone">Your Contact Phone <span class="required">*</span></label>
                    <input type="tel" id="contactPhone" name="contactPhone" required placeholder="Enter your number" maxlength="10">
                    <span class="error-message" id="contactPhone-error">A valid phone number is required.</span>
                </div>

                <div class="form-group">
                    <label for="itemImage">Upload Image (Optional, but highly recommended)</label>
                    <input type="file" id="itemImage" name="itemImage" accept="image/*">
                    <div class="image-preview" id="imagePreview">
                        <img id="previewImage" src="" alt="Image preview">
                        <br>
                        <button type="button" class="remove-image" id="removeImage">Remove Image</button>
                    </div>
                    <p class="help-text">Max file size: 5MB. Supported formats: JPG, PNG, GIF.</p>
                </div>

                <div class="loading-spinner" id="loadingSpinner">
                    <div class="spinner"></div>
                    <p>Submitting your report and notifying admin...</p>
                </div>

                <div class="submit-section">
                    <button type="submit" class="btn btn-primary"><i class="fas fa-paper-plane"></i> Submit Report</button>
                    <div class="info-icon-container">
                        <i style="margin-top: 20px;" class="fas fa-info-circle info-icon"></i>
                        <div class="info-tooltip">
                            <ol>
                                <dh>
                                    1. Before Submission:
                                </dh>
                                <dd>
                                    Please check that all details are correct. Accurate info helps us process your report quickly.
                                </dd>
                                <hr>
                                <dh>
                                    2. After Successful Submission:
                                </dh>
                                <dd>
                                    Your report will submitted successfully! Our coordinator will contact you soon. Thank you!
                                </dd>
                            </ol>
                        </div>
                    </div>
                </div>
            </form>
        </section>
    </main>

    <div class="success-modal-backdrop" id="successModal">
        <div class="success-modal">
            <div class="success-icon">
                <i class="fas fa-check"></i>
            </div>
            <h2>Submitted Successfully!</h2>
            <p>Our coordinator will contact you ASAP.</p>
            <button class="success-button" id="successButton">OK</button>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2025 College Lost & Found Hub. All rights reserved.</p>
            <div class="footer-links">
                <a href="#" id="privacyLink" aria-label="Privacy Policy">Privacy Policy</a> | 
                <a href="#" id="serviceLink" aria-label="Terms of Service">Terms of Service</a> | 
                <a href="#" id="termsLink" aria-label="Terms & Conditions">Terms & Conditions</a>
            </div>
        </div>
    </footer>

    <div class="modal-backdrop" id="modalBackdrop"></div>

    <div class="modal" id="privacyModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 style="color:#007BFF;">Lost & Found Hub - Privacy Policy</h3>
          <button class="close-btn">&times;</button>
        </div>
        <div class="modal-body">
                <h4>1. Information We Collect</h4>
                <p>To provide our lost and found matching services, we collect:
                    <ul>
                        <li>Account information (name, email, contact details)</li>
                        <li>Item descriptions and photos you choose to share</li>
                        <li>Location data to help match lost and found items geographically</li>
                        <li>Communication history between users regarding items</li>
                        <li>Technical data (IP address, browser type, device information)</li>
                    </ul>
                </p>
                
                <h4>2. How We Use Your Information</h4>
                <p>We use collected information to:
                    <ul>
                        <li>Match lost items with found items in your area</li>
                        <li>Facilitate communication between users</li>
                        <li>Improve our matching algorithms and user experience</li>
                        <li>Send notifications about potential matches</li>
                        <li>Ensure platform security and prevent fraud</li>
                        <li>Comply with legal obligations</li>
                    </ul>
                </p>
                
                <h4>3. Item Information Sharing</h4>
                <p>To help reunite items with their owners, we may share:
                    <ul>
                        <li>Item descriptions and photos with other users in your area</li>
                        <li>General location data (neighborhood/city level, not exact addresses)</li>
                        <li>Contact method you choose to share (platform messaging or provided contact info)</li>
                    </ul>
                    We never share your exact address, phone number, or personal financial information without your explicit consent.
                </p>
                
                <h4>4. Data Security</h4>
                <p>We implement security measures to protect your information:
                    <ul>
                        <li>Encryption of sensitive data in transit and at rest</li>
                        <li>Regular security assessments and updates</li>
                        <li>Limited employee access to user data</li>
                        <li>Secure authentication procedures</li>
                    </ul>
                </p>
                
                <h4>5. Your Privacy Choices</h4>
                <p>You can:
                    <ul>
                        <li>Adjust visibility settings for your listings</li>
                        <li>Choose which contact methods to share</li>
                        <li>Delete your account and associated data</li>
                        <li>Opt-out of non-essential communications</li>
                        <li>Request access to your personal data</li>
                    </ul>
                </p>
                
                <h4>6. Location Data</h4>
                <p>We use location information to:
                    <ul>
                        <li>Show relevant lost and found items in your area</li>
                        <li>Improve matching accuracy</li>
                        <li>Provide location-based notifications</li>
                    </ul>
                    You can control location sharing through your device settings and our app permissions.
                </p>
                
                <h4>7. Data Retention</h4>
                <p>We retain your information:
                    <ul>
                        <li>While your account is active</li>
                        <li>For resolved item listings: 90 days after resolution</li>
                        <li>For unresolved listings: Until you delete them or 1 year</li>
                        <li>As required by law for legal compliance</li>
                    </ul>
                </p>
                
                <h4>8. Changes to Privacy Policy</h4>
                <p>We will notify users of significant changes to our privacy practices. Continued use of Lost & Found Hub after changes constitutes acceptance of the updated policy.</p>
                
                <h4>9. Contact Us</h4>
                <p>For privacy-related questions or concerns, please contact our privacy team at privacy@lostfoundhub.com</p>
            </div>
      </div>
    </div>

    <div class="modal" id="serviceModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 style="color: #007BFF;">Lost & Found Hub - Terms of Service</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <h4>1. Our Service</h4>
                <p>Welcome to Lost & Found Hub. Our service provides a platform to help users post and search for lost and found items within a specific community. We aim to facilitate the return of belongings but do not participate in the exchange or guarantee outcomes.</p>
                <h4>2. User Accounts</h4>
                <p>To post an item, you may be required to create an account. You agree to provide truthful information and are responsible for maintaining the confidentiality of your account password. You are solely responsible for all activities that occur under your account.</p>
                <h4>3. Acceptable Use Policy</h4>
                <p>You agree not to use the service to post false or misleading information, harass other users, or post unlawful content.</p>
                <h4>4. User-Generated Content</h4>
                <p>You retain ownership of the content you post. However, by posting, you grant Lost & Found Hub a license to display that content on our platform for the purpose of operating the service.</p>
                <h4>5. Termination</h4>
                <p>We reserve the right to suspend or terminate your access to the service at our discretion for any conduct that violates these terms.</p>
            </div>
        </div>
    </div>

    <div class="modal" id="termsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Lost & Found Hub - Terms & Conditions</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <h4>1. Acceptance of Terms</h4>
                <p>By accessing and using Lost & Found Hub, you accept and agree to be bound by these Terms & Conditions. Our platform connects people who have lost items with those who have found them.</p>
                
                <h4>2. User Responsibilities</h4>
                <p>As a user of Lost & Found Hub, you agree to:
                    <ul>
                        <li>Provide accurate information about lost or found items</li>
                        <li>Respond promptly to legitimate inquiries about your listings</li>
                        <li>Treat other users with respect and courtesy</li>
                        <li>Not list prohibited or illegal items</li>
                        <li>Verify ownership before returning found items</li>
                    </ul>
                </p>
                
                <h4>3. Item Listings and Verification</h4>
                <p>Lost & Found Hub serves as a connection platform only. We do not:
                    <ul>
                        <li>Verify the accuracy of user listings</li>
                        <li>Guarantee the return of lost items</li>
                        <li>Take possession of any lost or found items</li>
                        <li>Mediate disputes between users</li>
                    </ul>
                    Users are responsible for verifying ownership through reasonable means before transferring items.
                </p>
                
                <h4>4. Prohibited Items</h4>
                <p>You may not list the following items on our platform:
                    <ul>
                        <li>Weapons, firearms, or ammunition</li>
                        <li>Illegal substances or drugs</li>
                        <li>Hazardous materials</li>
                        <li>Stolen property</li>
                        <li>Perishable items</li>
                        <li>Animals or pets</li>
                    </ul>
                </p>
                
                <h4>5. Safe Exchange Guidelines</h4>
                <p>For your safety, we recommend:
                    <ul>
                        <li>Meeting in public, well-lit areas</li>
                        <li>Bringing a friend or family member</li>
                        <li>Verifying the item matches the description</li>
                        <li>Not sharing personal financial information</li>
                        <li>Reporting suspicious activity to local authorities</li>
                    </ul>
                </p>
                
                <h4>6. Limitation of Liability</h4>
                <p>Lost & Found Hub is not responsible for:
                    <ul>
                        <li>Items that are not returned or claimed</li>
                        <li>Misrepresentation of items by users</li>
                        <li>User interactions or exchanges</li>
                        <li>Damages or losses resulting from platform use</li>
                        <li>Technical issues that may temporarily limit access</li>
                    </ul>
                </p>
                
                <h4>7. Account Termination</h4>
                <p>We reserve the right to suspend or terminate accounts that:
                    <ul>
                        <li>Violate these terms and conditions</li>
                        <li>Engage in fraudulent or suspicious activity</li>
                        <li>Harass other users</li>
                        <li>Repeatedly post inaccurate information</li>
                    </ul>
                </p>
                
                <h4>8. Changes to Terms</h4>
                <p>We may update these Terms & Conditions periodically. Continued use of Lost & Found Hub after changes constitutes acceptance of the modified terms.</p>
            </div>
        </div>
    </div>

    <script>
        // Initialize EmailJS
        emailjs.init("ieCJeX-5LsiuaA20c");

        // Modal functionality for footer links
        const modalBackdrop = document.getElementById('modalBackdrop');
        const privacyModal = document.getElementById('privacyModal');
        const serviceModal = document.getElementById('serviceModal');
        const termsModal = document.getElementById('termsModal');
        const privacyLink = document.getElementById('privacyLink');
        const serviceLink = document.getElementById('serviceLink');
        const termsLink = document.getElementById('termsLink');

        // Open modal functions
        function openModal(modal) {
            modalBackdrop.style.display = 'block';
            modal.style.display = 'block';
            document.body.classList.add('modal-open');
        }

        function closeModals() {
            modalBackdrop.style.display = 'none';
            privacyModal.style.display = 'none';
            serviceModal.style.display = 'none';
            termsModal.style.display = 'none';
            document.body.classList.remove('modal-open');
        }

        // Event listeners for footer links
        privacyLink.addEventListener('click', function(e) {
            e.preventDefault();
            openModal(privacyModal);
        });

        serviceLink.addEventListener('click', function(e) {
            e.preventDefault();
            openModal(serviceModal);
        });

        termsLink.addEventListener('click', function(e) {
            e.preventDefault();
            openModal(termsModal);
        });

        // Close modals
        modalBackdrop.addEventListener('click', closeModals);
        
        document.querySelectorAll('.close-btn').forEach(btn => {
            btn.addEventListener('click', closeModals);
        });

        // Close with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModals();
            }
        });

        // Function to update avatars in header
        function updateHeaderAvatars(avatarUrl) {
            const accountIconImage = document.getElementById('accountIconImage');
            const accountIconFallback = document.getElementById('accountIconFallback');
            const dropdownAvatarImage = document.getElementById('dropdownAvatarImage');
            const dropdownAvatarFallback = document.getElementById('dropdownAvatarFallback');
            
            if (avatarUrl && avatarUrl !== '') {
                // Update account icon
                accountIconImage.src = avatarUrl;
                accountIconImage.style.display = 'block';
                accountIconFallback.style.display = 'none';
                
                // Update dropdown avatar
                dropdownAvatarImage.src = avatarUrl;
                dropdownAvatarImage.style.display = 'block';
                dropdownAvatarFallback.style.display = 'none';
            } else {
                // Show fallback icons if no avatar
                accountIconImage.style.display = 'none';
                accountIconFallback.style.display = 'block';
                dropdownAvatarImage.style.display = 'none';
                dropdownAvatarFallback.style.display = 'block';
            }
        }

        // Function to update user info
        function updateUserInfo(username, email) {
            const usernameElement = document.getElementById('username');
            const useremailElement = document.getElementById('useremail');
            
            if (username) {
                usernameElement.textContent = username;
            }
            
            if (email) {
                useremailElement.textContent = email;
            }
        }

        // Function to fetch user profile from database
        async function fetchUserProfile() {
            try {
                const token = localStorage.getItem('authToken');
                if (!token) {
                    console.log('No authentication token found');
                    return null;
                }

                // Fetch user profile from your backend API
                const response = await fetch('http://localhost:3000/api/profile', {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error('Failed to fetch user profile');
                }

                const result = await response.json();
                
                if (result.success) {
                    return result.user;
                } else {
                    throw new Error(result.message || 'Failed to fetch user profile');
                }
            } catch (error) {
                console.error('Error fetching user profile:', error);
                return null;
            }
        }

        // Toggle account dropdown
        document.getElementById('accountIcon').addEventListener('click', function(e) {
            e.stopPropagation();
            document.getElementById('accountDropdown').classList.toggle('active');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const accountSection = document.getElementById('accountSection');
            if (!accountSection.contains(event.target)) {
                document.getElementById('accountDropdown').classList.remove('active');
            }
        });

        // Mobile menu toggle
        document.getElementById('hamburgerMenu').addEventListener('click', function() {
            document.getElementById('mainNav').classList.toggle('active');
        });

        // Logout functionality
        document.querySelector('.logout-btn').addEventListener('click', function(e) {
            e.preventDefault();
            // Clear any stored authentication data
            localStorage.removeItem('authToken');
            // Redirect to login page
            window.location.href = 'login.html';
        });

        // Image preview functionality
        document.getElementById('itemImage').addEventListener('change', function(event) {
            const file = event.target.files[0];
            const preview = document.getElementById('imagePreview');
            const previewImage = document.getElementById('previewImage');
            
            if (file) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    previewImage.src = e.target.result;
                    preview.style.display = 'block';
                }
                
                reader.readAsDataURL(file);
            } else {
                preview.style.display = 'none';
            }
        });

        // Remove image functionality
        document.getElementById('removeImage').addEventListener('click', function() {
            document.getElementById('itemImage').value = '';
            document.getElementById('imagePreview').style.display = 'none';
        });

        // Form submission handler
        document.getElementById('itemForm').addEventListener('submit', async function(event) {
            event.preventDefault();
            
            // Validate form
            if (!validateForm()) {
                return;
            }

            // Show loading spinner
            document.getElementById('loadingSpinner').style.display = 'block';

            try {
                // Get form data for email
                const emailData = {
                    itemType: document.querySelector('input[name="itemType"]:checked').value,
                    itemName: document.getElementById('itemName').value.trim(),
                    category: document.getElementById('category').value,
                    description: document.getElementById('description').value.trim(),
                    location: document.getElementById('location').value.trim(),
                    date: document.getElementById('date').value,
                    contactEmail: document.getElementById('contactEmail').value.trim(),
                    contactPhone: document.getElementById('contactPhone').value.trim(),
                    timestamp: new Date().toLocaleString(),
                    hasImage: !!document.getElementById('itemImage').files[0],
                    // Add sender information for email template
                    from_name: "Lost & Found Portal User",
                    from_email: document.getElementById('contactEmail').value.trim(),
                    to_email: "lostnfoundhub1@gmail.com"
                };

                console.log('Sending email notification...');
                
                // Send email notification only
                const emailResult = await emailjs.send(
                    'service_csp5v7g', 
                    'template_ye5sd7p', 
                    emailData
                );
                console.log('Email sent successfully:', emailResult);

                // Hide loading spinner
                document.getElementById('loadingSpinner').style.display = 'none';

                // Show success modal
                document.getElementById('successModal').style.display = 'flex';

                // Reset form
                document.getElementById('itemForm').reset();
                document.getElementById('imagePreview').style.display = 'none';
                document.getElementById('date').valueAsDate = new Date();

            } catch (error) {
                console.error('Submission error:', error);
                document.getElementById('loadingSpinner').style.display = 'none';
                
                if (error.message.includes('login')) {
                    alert('Please login to submit an item');
                    window.location.href = 'login.html';
                } else {
                    alert('Error: ' + error.message);
                }
            }
        });

        // Form validation function
        function validateForm() {
            let isValid = true;

            // Reset error messages
            document.querySelectorAll('.error-message').forEach(msg => {
                msg.style.display = 'none';
            });

            // Validate item type
            const itemType = document.querySelector('input[name="itemType"]:checked');
            if (!itemType) { 
                document.getElementById('itemType-error').style.display = 'block'; 
                isValid = false; 
            }

            // Validate item name
            const itemName = document.getElementById('itemName').value.trim();
            if (!itemName) { 
                document.getElementById('itemName-error').style.display = 'block'; 
                isValid = false; 
            }

            // Validate category
            const category = document.getElementById('category').value;
            if (!category) { 
                document.getElementById('category-error').style.display = 'block'; 
                isValid = false; 
            }

            // Validate description
            const description = document.getElementById('description').value.trim();
            if (!description) { 
                document.getElementById('description-error').style.display = 'block'; 
                isValid = false; 
            }

            // Validate location
            const location = document.getElementById('location').value.trim();
            if (!location) { 
                document.getElementById('location-error').style.display = 'block'; 
                isValid = false; 
            }

            // Validate date
            const date = document.getElementById('date').value;
            if (!date) { 
                document.getElementById('date-error').style.display = 'block'; 
                isValid = false; 
            }

            // Validate email
            const email = document.getElementById('contactEmail').value.trim();
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!email || !emailRegex.test(email)) { 
                document.getElementById('contactEmail-error').style.display = 'block'; 
                isValid = false; 
            }

            // Validate phone
            const phone = document.getElementById('contactPhone').value.trim();
            const phoneRegex = /^\d{10}$/;
            if (!phone || !phoneRegex.test(phone)) { 
                document.getElementById('contactPhone-error').style.display = 'block'; 
                isValid = false; 
            }

            return isValid;
        }

        // Close success modal when the OK button is clicked
        document.getElementById('successButton').addEventListener('click', function() {
            document.getElementById('successModal').style.display = 'none';
        });

        // Also close modal when clicking outside the modal content
        document.getElementById('successModal').addEventListener('click', function(e) {
            if (e.target === this) {
                this.style.display = 'none';
            }
        });

        // Set today's date as default
        document.getElementById('date').valueAsDate = new Date();

        // Load user profile and check authentication on page load
        document.addEventListener('DOMContentLoaded', async function() {
            const token = localStorage.getItem('authToken');
            if (!token) {
                alert('Please login to submit an item');
                window.location.href = 'login.html';
                return;
            }

            try {
                // Fetch user profile from database
                const userProfile = await fetchUserProfile();
                
                if (userProfile) {
                    // Update user info with data from database
                    updateUserInfo(
                        userProfile.username || userProfile.name || 'User',
                        userProfile.email || 'user@example.com'
                    );
                    
                    // Update avatar with user's original image from database
                    if (userProfile.avatar) {
                        updateHeaderAvatars(userProfile.avatar);
                    } else {
                        // Use default avatar if no image in database
                        // updateHeaderAvatars('https://i.pravatar.cc/150?img=12');
                    }
                } else {
                    // Fallback to demo data if fetch fails
                    console.log('Using demo data as fallback');
                    updateUserInfo('nivesharm', 'nivesharm@example.com');
                    // updateHeaderAvatars('https://i.pravatar.cc/150?img=12');
                }
            } catch (error) {
                console.error('Error loading user profile:', error);
                // Fallback to demo data
                updateUserInfo('nivesharm', 'nivesharm@example.com');
                // updateHeaderAvatars('https://i.pravatar.cc/150?img=12');
            }
        });
    </script>
</body>
</html>